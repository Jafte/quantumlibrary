{% extends "story/base.html" %}

{% load account %}

{% block title %}{{ story.title }}{% endblock %}

{% block breadcrumbs_path %}
    <li><a href="{% url 'story_list' %}">Истории</a></li>
{% endblock %}

{% block breadcrumbs_active %}
    <li class="active">{{ story.title }}</li>
{% endblock %}

{% block content %}
<article class="uk-article">
    <h1 class="uk-article-title">{{ story.title }}</h1>
    {% if story.creator == user %}
        <a href="{% url 'story_edit' story.pk %}">
            править
        </a>
    {% endif %}
    {% for part in story_parts %}
        <div class="uk-panel uk-panel-hover" id="part-{{ part.pk }}">
            <div class="uk-panel-badge">
                {% if part.author == user %}
                <div class="uk-badge uk-badge-success">вы создатель отрывка</div>
                {% endif %}

                {% if part.is_child_node %}
                <a href="{% url 'story_part_create' story.pk part.parent.pk %}">
                    <div class="uk-badge uk-badge-danger">
                        <i class="uk-icon-code-fork"></i> предложить свою версию
                    </div>
                </a>
                {% endif %}
                {% if part.get_siblings %}
                <a class="modal-story-variants-show" href="{% url 'story_detail_part_variants' story.pk part.pk %}" data-uk-modal='{"target":"#modal-story-variants"}'>
                    <div class="uk-badge uk-badge-warning">
                        <i class="uk-icon-sitemap"></i>
                        алтернативные варианты
                    </div>
                </a>
                {% endif %}
            </div>

            <p>{{ part.text }}</p>
        </div>
    {% empty %}
        <div class="uk-panel uk-panel-box">
            <p class="uk-panel-title">Тлен и пустота в твоей истории :(</p>
        </div>
    {% endfor %}
    <hr class="uk-article-divider" />
    <a class="uk-button" href="{% url 'story_part_create' story.pk primary_story_line.pk %}">
        продолжить историю
    </a>
</article>
{% endblock %}